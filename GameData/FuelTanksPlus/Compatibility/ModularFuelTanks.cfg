@PART[TPtank*|TPcone*|TPdome*]:NEEDS[ModularFuelTanks]
{
	origLFO = 0
}
@PART:HAS[#origLFO[0],@RESOURCE[LiquidFuel]:HAS[#maxAmount[>0]]]:NEEDS[ModularFuelTanks]
{
	@origLFO += #$RESOURCE[LiquidFuel]:HAS[#maxAmount[>0]]/maxAmount$
}
@PART:HAS[#origLFO[*],@RESOURCE[Oxidizer]:HAS[#maxAmount[>0]]]:NEEDS[ModularFuelTanks]
{
	@origLFO += #$RESOURCE[Oxidizer]:HAS[#maxAmount[>0]]/maxAmount$
}
@PART:HAS[#origLFO[>-1]]:NEEDS[ModularFuelTanks]
{
	MODULE
	{
		name = ModuleFuelTanks
		volume = #$../origLFO$
		type = Default
	}
}
@PART[TPtank*|TPcone*|TPdome*]:NEEDS[ModularFuelTanks]
{
	!origLFO = delete
}

// Fix-ups:

@PART[TPtank*Nuke]:AFTER[FuelTanksPlus]
{
    @MODULE[ModuleFuelTanks]
    {
	@type = Fuselage
    }
}
@PART[TPtankR*MP]:AFTER[FuelTanksPlus]
{
    @MODULE[ModuleFuelTanks]
    {
	@type = RCS
	@volume *= 1.25
    }
}
